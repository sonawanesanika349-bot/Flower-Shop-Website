<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Greenery World</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container">
            <a class="navbar-brand" href="#">Greenery World</a>
            <div class="navbar-nav ms-auto">
                <a class="nav-link" href="index.html">Home</a>
                <a class="nav-link" href="order.html">Order</a>
                <a class="nav-link active" href="dashborad.html">Dashboard</a>
            </div>
        </div>
    </nav>

    <div class="container mt-5">
        <div class="row mb-4">
            <div class="col-md-8">
                <h1 class="h3">Welcome back!</h1>
                <p class="text-muted">This is your dashboard. Manage orders, view account details, and place new orders.</p>
            </div>
            <div class="col-md-4 text-md-end">
                <a href="order.html" class="btn btn-success">Place new order</a>
                <a href="login.html" class="btn btn-outline-secondary">Logout</a>
            </div>
        </div>

        <div class="row g-4">
            <div class="col-lg-4">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Account</h5>
                        <p class="card-text">Username: <strong>Guest</strong></p>
                        <p class="card-text">Member since: <strong>—</strong></p>
                        <a href="login.html" class="btn btn-sm btn-primary">Edit profile</a>
                    </div>
                </div>
            </div>

            <div class="col-lg-8">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Recent Orders</h5>
                        <div id="orders">
                            <p class="text-muted">Loading orders…</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="row mt-4">
            <div class="col-md-12">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Quick Actions</h5>
                        <div class="d-flex gap-2 flex-wrap">
                            <a href="order.html" class="btn btn-outline-primary">Order Flowers</a>
                            <a href="about.html" class="btn btn-outline-secondary">About Us</a>
                            <a href="register.html" class="btn btn-outline-success">Create Account</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="scripts.js"></script>
    <script>
        // Try to fetch recent orders from backend; if it fails, show a friendly note.
        (function(){
            const ordersDiv = document.getElementById('orders');
            fetch('php/orders.php')
                .then(r => {
                    if (!r.ok) throw new Error('No orders endpoint');
                    return r.json();
                })
                .then(data => {
                    if (!data || data.length === 0) {
                        ordersDiv.innerHTML = '<p class="text-muted">No recent orders.</p>';
                        return;
                    }
                    let html = '<div class="table-responsive"><table class="table table-sm"><thead><tr><th>Order ID</th><th>Flower</th><th>Qty</th><th>Total</th><th>Date</th></tr></thead><tbody>';
                    html += data.map(o => `<tr><td>${o.id}</td><td>${o.flower_type || o.flowerType}</td><td>${o.quantity}</td><td>${o.total_price||o.total}</td><td>${o.order_date||o.date}</td></tr>`).join('');
                    html += '</tbody></table></div>';
                    ordersDiv.innerHTML = html;
                })
                .catch(err => {
                    // Backend not implemented yet — show useful message and example rows
                    ordersDiv.innerHTML = `
                        <p class="text-muted">Orders not available (backend endpoint missing).</p>
                        <table class="table table-sm">
                            <thead><tr><th>Order ID</th><th>Flower</th><th>Qty</th><th>Total</th><th>Date</th></tr></thead>
                            <tbody>
                                <tr><td>#1001</td><td>Roses</td><td>12</td><td>$179.88</td><td>2025-11-01</td></tr>
                                <tr><td>#1000</td><td>Tulips</td><td>8</td><td>$79.92</td><td>2025-10-28</td></tr>
                            </tbody>
                        </table>
                        <p class="small text-muted">To enable live orders, add a 'php/orders.php' API that returns order rows as JSON for the logged-in user.</p>
                    `;
                });
        })();
    </script>
</body>
</html>